# macOS专用字幕转写工具
源自OpenAI的Whisper v3 large模型，能支持上百种语言，具体能力不多赘述。

这个工具可以充分利用macOS M系列芯片的硬件加速，运行效率非常高。

## 使用方法
直接克隆这个工程，我已经把常用的东西变成脚本了，直接运行就可以了，无须专业操作。

注意，这个模型比较大，会占用大概10GB左右的内存，如果内存不够大，请不要轻易尝试这个软件。

只能支持Apple Silicon的芯片，系统版本建议macOS 15+，太老的系统或者硬件没试过会怎么样。

### 安装依赖
双击`install.command`脚本，就会自动下载所需的所有文件。

可能会比较慢，因为有一个大模型好几个GB。

### 卸载安装
双击`uninstall.command`脚本，就会把所有的东西清理干净，然后直接删除这个目录就可以了。

### 运行程序
双击`run.command`，稍作等待之后（第一次启动可能会有点慢，猜测是Rosetta导致的，下面会说），会弹出来一个文件选择框，此时选择你需要生成字幕的视频文件。目前支持mp4和mov格式。

选择文件后，会加载模型，然后运行过程中的日志会在窗口中打印。在M2 Max级别（笔者的电脑已经是好几年前的了，新的肯定更加快）的芯片上，这个运行速度是非常快的，一分钟就可以转写几分钟的字幕。

全部转写完成后，会弹出一个文件选择框，选择你的srt字幕文件想要保存的位置即可。

## python的症结（专业使用者看这里）
这个工具为了方便分发使用，我们**没有**额外携带一个python的运行时，使用的是系统自带的远古python。这个是macOS自身的一些臭屁问题导致的。
python官方并没有为macOS提供一个像Windows Embedded Python那种那么方便的运行时，而且macOS本身权限问题检查得很严格，任何没签名的动态库或者install name不对劲的东西，对分发都很容易造成困扰。我自己尝试了用homebrew版本移植的一个python，基本上各种功能都废了。兴许后面有空可能会额外研究一下怎么移植python。

### 运行起来好像不少warning，第一次运行还特别慢
系统自带的python的锅呗。那个python似乎是3.9（我的macOS是15.4版本，5202年了在这里见到python 3.9属实是见到太奶了）这个python版本特别特别老，它的tkinter似乎是Rosetta转译的，甚至连ssl支持都有点问题。
所以第一次运行这个软件的时候，因为调用系统的文件选择框用到了tkinter，加载模型的那个hugging face，还有一些可能用到的原生库，似乎就触发了Rosetta的转译导致各种东西都特别慢。
我换过别的python版本，比如homebrew安装的3.13，那就完全没问题了。

### 似乎问题都集中在python运行时了
这是个好问题，如果你是专业的开发者，知道如何使用homebrew安装python的话，那么我强烈建议你，自行安装一个新版本的python和python-tk，然后，修改`install.command`对应的内容
``` shell
...

# 创建venv
cd "$(dirname "$0")"
/usr/bin/python3 -m venv .

...
```
把这一行`/usr/bin/python3`这里，换成你自己安装的新的python的可执行文件的路径就可以了。

### 怎么自己实现Embeded Python
后话……等我有空研究清楚先